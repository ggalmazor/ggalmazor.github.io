<!DOCTYPE html>
<html lang="en">
<title></title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">
<body class="w-100 avenir black-70 bg-white pa3">
<nav class="center w-100 mw7 mb5 flex justify-between items-end">
    <a href="/" class="dib ttu link dim black-70 fw6 pt3 pr3 pb3">ggalmazor.com</a>
    <span class="dib w-100"></span>
    <a href="https://twitter.com/ggalmazor" class="dib link dim black-70 pa3">@ggalmazor</a>
    <a href="/about.html" class="dib ttu link dim black-70 pt3 pb3 pl3">about</a>
</nav>
<section class="w-100 mw7 center">
    <h1 class="h1 mb4">Poolish bread recipe calculator</h1>

    <p>This is an ingredient calculator for breads with poolish preferment. All quantities are expressed in grams. All yeast quantities are assumed to be of dry yeast, unless noted otherwise. If you're using fresh yeast, you'll have to multiply it by 3.</p>

    <section>
        <h2 class="h2 mb0">Parameters</h2>
        <div class="flex flex-column flex-row-ns">
            <div class="w-100 w-33-ns pr3">
                <h2 class="h2 mb4">Overall</h2>
                <div>
                    <label for="total_dough_weight" class="f6 b db mb2">Desired dough weight <span class="normal black-60">(grams)</span></label>
                    <input id="total_dough_weight" name="total_dough_weight" type="number" value="1000" min="0" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>

                <div>
                    <label for="dough_hydration_percentage" class="f6 b db mb2">Desired dough hydration <span class="normal black-60">(%)</span></label>
                    <input id="dough_hydration_percentage" name="dough_hydration_percentage" type="number" value="80" max="100" min="0" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>
            </div>
            <div class="w-100 w-33-ns ph3">
                <h2 class="h2 mb4">Poolish</h2>

                <div>
                    <label for="poolish_percentage" class="f6 b db mb2">Poolish percentage <span class="normal black-60">(%)</span></label>
                    <input id="poolish_percentage" name="poolish_percentage" type="number" value="40" max="100" min="0" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>

                <div>
                    <label for="poolish_hydration_percentage" class="f6 b db mb2">Hydration percentage <span class="normal black-60">(%)</span></label>
                    <input id="poolish_hydration_percentage" name="poolish_hydration_percentage" type="number" value="125" min="0" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>

                <div>
                    <label for="poolish_yeast_percentage" class="f6 b db mb2">Poolish yeast percentage <span class="normal black-60">(%)</span></label>
                    <input id="poolish_yeast_percentage" name="poolish_yeast_percentage" type="number" value="0.1" min="0" step="0.1" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>
            </div>
            <div class="w-100 w-33-ns pl3">
                <h2 class="h2 mb4">Rest of dough</h2>

                <div>
                    <label for="salt_percentage" class="f6 b db mb2">Salt percentage <span class="normal black-60">(%)</span></label>
                    <input id="salt_percentage" name="salt_percentage" type="number" value="2.4" min="0" step="0.1" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>

                <div>
                    <label for="rest_yeast_percentage" class="f6 b db mb2">Yeast percentage for the rest <span class="normal black-60">(%)</span></label>
                    <input id="rest_yeast_percentage" name="rest_yeast_percentage" type="number" value="0.1" min="0" step="0.1" class="db border-box hover-black ba b--black-20 pa2 br2 mb2"/>
                </div>
            </div>
        </div>
    </section>

    <hr/>

    <section>
        <h2 class="h2 mb0">Recipe</h2>
        <div class="flex flex-column flex-row-ns">
            <div class="w-100 w-33-ns pa3 mr2">
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Total flour:</dt>
                    <dd class="dib ml0 gray" id="total_flour_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Total water:</dt>
                    <dd class="dib ml0 gray" id="total_water_weight">0 g</dd>
                </dl>
            </div>
            <div class="w-100 w-33-ns pa3 mr2">
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Poolish flour:</dt>
                    <dd class="dib ml0 gray" id="poolish_flour_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Poolish water:</dt>
                    <dd class="dib ml0 gray" id="poolish_water_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Poolish yeast:</dt>
                    <dd class="dib ml0 gray" id="poolish_yeast_weight">0 g</dd>
                </dl>
            </div>
            <div class="w-100 w-33-ns pa3 mr2">
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Rest of flour:</dt>
                    <dd class="dib ml0 gray" id="rest_flour_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Rest of water:</dt>
                    <dd class="dib ml0 gray" id="rest_water_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Rest of yeast:</dt>
                    <dd class="dib ml0 gray" id="rest_yeast_weight">0 g</dd>
                </dl>
                <dl class="f6 lh-title mv2">
                    <dt class="dib b">Salt:</dt>
                    <dd class="dib ml0 gray" id="salt_weight">0 g</dd>
                </dl>
            </div>
        </div>
    </section>
    <hr/>
    <section>
        <h2 class="h2 mb0">Formulae</h2>
        <ul class="list pa0">
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">total flour = desired dough / (1 + hydration percentage)</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">total water = desired dough - total flour</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">poolish flour = total flour * poolish percentage</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">poolish water = poolish flour * poolish hydration percentage</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">poolish yeast = poolish flour * poolish yeast percentage</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">rest of flour = total flour - poolish flour</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">rest of water = total water - poolish water</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">rest of yeast = total flour - rest of dough yeast percentage</li>
            <li class="lh-copy pv3 ba bl-0 bt-0 br-0 b--dotted b--black-30">salt = total flour * salt percentage</li>
        </ul>
    </section>
</section>

<script>

  function round(number, decimalPlaces = 0) {
    const factor = Math.pow(10, decimalPlaces);
    return Math.round(number * factor) / factor;
  }

  function computeRecipe(dom) {
    const hydrationPercentage = dom.dough_hydration_percentage() / 100;
    const totalFlourWeight = dom.total_dough_weight() / (1 + hydrationPercentage);
    const totalWaterWeight = dom.total_dough_weight() - totalFlourWeight;
    const poolishFlourWeight = totalFlourWeight * (dom.poolish_percentage() / 100);
    const poolishWaterWeight = poolishFlourWeight * (dom.poolish_hydration_percentage() / 100);
    const poolishYeastWeight = poolishFlourWeight * (dom.poolish_yeast_percentage() / 100);
    const restFlourWeight = totalFlourWeight - poolishFlourWeight;
    const restWaterWeight = totalWaterWeight - poolishWaterWeight;
    const restYeastWeight = totalFlourWeight * (dom.rest_yeast_percentage() / 100);
    const saltWeight = totalFlourWeight * (dom.salt_percentage() / 100);

    dom.total_flour_weight(round(totalFlourWeight));
    dom.total_water_weight(round(totalWaterWeight));
    dom.poolish_flour_weight(round(poolishFlourWeight));
    dom.poolish_water_weight(round(poolishWaterWeight));
    dom.poolish_yeast_weight(round(poolishYeastWeight, 2));
    dom.rest_flour_weight(round(restFlourWeight));
    dom.rest_water_weight(round(restWaterWeight));
    dom.rest_yeast_weight(round(restYeastWeight, 2));
    dom.salt_weight(round(saltWeight, 2));
  }

  document.addEventListener("DOMContentLoaded", () => {
    const dom = {
      total_dough_weight: () => parseInt(document.querySelector("#total_dough_weight").value),
      dough_hydration_percentage: () => parseInt(document.querySelector('#dough_hydration_percentage').value),
      poolish_percentage: () => parseInt(document.querySelector('#poolish_percentage').value),
      poolish_hydration_percentage: () => parseInt(document.querySelector('#poolish_hydration_percentage').value),
      poolish_yeast_percentage: () => parseFloat(document.querySelector('#poolish_yeast_percentage').value),
      salt_percentage: () => parseFloat(document.querySelector('#salt_percentage').value),
      rest_yeast_percentage: () => parseFloat(document.querySelector('#rest_yeast_percentage').value),
      total_flour_weight: value => document.querySelector('#total_flour_weight').innerHTML = `${value}g`,
      total_water_weight: value => document.querySelector('#total_water_weight').innerHTML = `${value}g`,
      poolish_flour_weight: value => document.querySelector('#poolish_flour_weight').innerHTML = `${value}g`,
      poolish_water_weight: value => document.querySelector('#poolish_water_weight').innerHTML = `${value}g`,
      poolish_yeast_weight: value => document.querySelector('#poolish_yeast_weight').innerHTML = `${value}g`,
      rest_flour_weight: value => document.querySelector('#rest_flour_weight').innerHTML = `${value}g`,
      rest_water_weight: value => document.querySelector('#rest_water_weight').innerHTML = `${value}g`,
      rest_yeast_weight: value => document.querySelector('#rest_yeast_weight').innerHTML = `${value}g`,
      salt_weight: value => document.querySelector('#salt_weight').innerHTML = `${value}g`,
    }
    document.querySelectorAll("input").forEach(input => input.addEventListener("change", () => computeRecipe(dom)));
    computeRecipe(dom);
  });
</script>
</body>
</html>
